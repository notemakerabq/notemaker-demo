#!/bin/bash
echo
echo   "----------------   MYSQL INJECTION ATTACK ---------------"

websvc=$(kubectl get svc -n notemaker | grep LoadBalancer | grep nginx | awk '{ print $4 }')
echo "-- launching MYSQL inject attack on http://$websvc"
attackString="AND 1=0 UNION SELECT USER()"
curl -s -o responses/mysql-response.html -d "$attackString" $websvc

success=$(grep -c POST responses/mysql-response.html)
if [ "$success" == "1" ]; then
  echo "   >> MYSQL injection attack succeeded"
  echo "!----------  MYSQL INJECTION ATTACK SUCCESSFUL  ---------"
else
  echo "   >> MYSQL injection attack prevented"
  echo "-----------   MYSQL INJECTION ATTACK FAILED    ----------"
fi
echo


