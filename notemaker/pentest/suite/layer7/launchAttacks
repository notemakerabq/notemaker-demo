#!/bin/bash

[ "$#" -lt 1 ] && echo "you must pass in one or more of all|web|css|mysql|blind|pw|file" && exit
runit=$(echo $1 | egrep 'all|web|css|mysql|blind|pw|file')
[[ -z $runit ]] && exit

echo "========================================================="
echo "====  PENTEST: WEB CONTAINER OWASP TOP 10 ATTACKS   ====="
echo "========================================================="
echo

op=$1
did=false

[[ "$op" == *"web"* ]] && op=all

[[ ("$op" == *"all"* || "$op" == *"css"*) ]] && did=true && cssAttack

[[ ("$op" == *"all"* || "$op" == *"mysql"*) ]] && did=true && MYSQLInjection 

[[ ("$op" == *"all"* || "$op" == *"blind"*) ]] && did=true && blindSQLInjection 

[[ ("$op" == *"all"* || "$op" == *"pw"*) ]] && did=true && getCredentialsInjectionAttack 

[[ ("$op" == *"all"* || "$op" == *"file"*) ]] && did=true && fileUploadAttack

[[ ("$WAITFORKEY" == "true"  && "$did" == "true") ]] && echo "hit a key to continue" && read -r -n1 key

 
