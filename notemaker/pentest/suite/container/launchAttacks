#!/bin/bash

[ "$#" -lt 1 ] && echo "you must pass in one or more of all|container|dns|fs|proc" && exit

runit=$(echo $1 | egrep 'all|container|dns|fs|proc')
[[ -z $runit ]] && exit

op=$1
did=false

echo
echo "========================================================="
echo "=====  PENTEST: CONTAINER FOCUSED RUNTIME ATTACKS   ====="
echo "========================================================="
echo

[[ "$op" == *"container"* ]] && op=all

[[ ("$op" == *"all"* || "$op" == *"fs"*) ]] && did=true && filesystemAttack

[[ ("$op" == *"all"* || "$op" == *"dns"*) ]] && did=true && dnsAttack

[[ ("$WAITFORKEY" == "true"  && "$did" == "true") ]] && \
   echo && echo "    >> hit return key to launch rogue process attack" && read -r -n1 key

[[ ("$op" == *"all"* || "$op" == *"proc"*) ]] && did=true && processAttack

[[ ("$WAITFORKEY" == "true"  && "$did" == "true") ]] && \
   echo && echo "    >> hit return key to continue" && read -r -n1 key

echo

